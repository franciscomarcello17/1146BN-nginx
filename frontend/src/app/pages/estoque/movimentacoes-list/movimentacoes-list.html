<div class="container">
  <div class="card">
    <div class="header">
      <h2>Histórico de Movimentações</h2>
      <button class="btn-secondary" routerLink="/cadastros/produtos">
        Voltar para Produtos
      </button>
    </div>

    <div *ngIf="carregando" class="loading">
      Carregando movimentações...
    </div>

    <div *ngIf="mensagem" class="mensagem" [class.error]="mensagem.includes('Erro')">
      {{ mensagem }}
    </div>

    <div *ngIf="!carregando && movimentacoes.length === 0" class="empty-state">
      Nenhuma movimentação registrada.
    </div>

    <div *ngIf="!carregando && movimentacoes.length > 0" class="content">
      <div class="stats">
        <div class="stat-card entrada">
          <h3>Entradas</h3>
          <div class="stat-value">
            {{ totalEntradas }}
          </div>
        </div>
        <div class="stat-card saida">
          <h3>Saídas</h3>
          <div class="stat-value">
            {{ totalSaidas }}
          </div>
        </div>
        <div class="stat-card total">
          <h3>Total</h3>
          <div class="stat-value">
            {{ totalMovimentacoes }}
          </div>
        </div>
      </div>

      <div class="table-container">
        <table class="table">
          <thead>
            <tr>
              <th>Data/Hora</th>
              <th>Produto</th>
              <th>Tipo</th>
              <th>Quantidade</th>
              <th>ID Mov.</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let mov of movimentacoes">
              <td>{{ formatarData(mov.data) }}</td>
              <td>{{ getNomeProduto(mov.produtoId) }}</td>
              <td>
                <span class="badge" [class]="getClasseTipo(mov.tipo)">
                  {{ getIconeTipo(mov.tipo) }} {{ getTipoMovimentacao(mov.tipo) }}
                </span>
              </td>
              <td>{{ mov.quantidade }} unidades</td>
              <td>#{{ mov.id }}</td>
              <td class="actions">
                <button 
                  class="btn-info" 
                  [routerLink]="['/estoque/produto', mov.produtoId]">
                  Ver Estoque
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>